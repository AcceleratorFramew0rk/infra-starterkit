#!/bin/bash

# Check if the input argument is 'get-resource-group'
if [ "$1" == "get-storage-account" ]; then
  # Execute the provided code
  PREFIX=$(yq -r '.prefix' /tf/avm/templates/landingzone/configuration/0-launchpad/scripts/config.yaml)
  RG_NAME="${PREFIX}-rg-launchpad"
  STG_NAME=$(az storage account list --resource-group "$RG_NAME" --query "[?contains(name, '${PREFIX//-/}stgtfstate')].[name]" -o tsv 2>/dev/null | head -n 1)
  echo "{\"storage_account_name\": \"$STG_NAME\", \"resource_group_name\": \"$RG_NAME\"}"
else
  echo "Usage: aaf [global options] "
  echo "  "
  echo "The available commands for execution are listed below."
  echo "The primary workflow commands are given first, followed by"
  echo "less common or more advanced commands."
  echo "  "
  echo "Main commands:"
  echo "  get-storage-account          Get the storage account name and resource group name for the Terraform state file."
fi
